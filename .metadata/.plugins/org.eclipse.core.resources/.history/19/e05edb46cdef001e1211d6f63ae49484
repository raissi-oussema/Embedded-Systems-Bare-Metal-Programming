/* Define all needed address BusReg to toggle a led attached pin5 on port B with proteus 8*/
#include 			"stm32f401xc.h"
#include 			"tim.h"
#include            "systick.h"
#include            <stdio.h>
#include 			"uart.h"


int __io_putchar(int ch){
	uart2_write(ch);
	return ch;
}
uint32_t timestamp=0;
void main(void)
{
	uart2_rxtx_init();
	tim2_pa5_compare_mode();
	tim3_pin6_input_capture();

	while (1){
		/*Wait until edge is captured*/
		while (!(TIM3->SR & TIM_SR_CC1IF)){}
		/*Read the value captured*/
		timestamp = TIM3->CCR1;
		char buffer[20];
		sprintf(buffer, "Register value: 0x%ld\r\n", timestamp);
		printf("%s \n\r", buffer);
		//systicDelayMs(1000);
	}
}
